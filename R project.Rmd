---
title: "Students' Preference"
author: "TUNDE Egunjobi"
date: "`r Sys.Date()`"
output: 
  html_document: 
    highlight: espresso
    toc: yes
---


#### **AIM**
The study aims to compare and contrast the physical and virtual learning environments based on their effect on students' academic performance and any other related factors.

#### **Objectives**
+ Exploratory Data Analysis
  
  + Data Visualization

+ Statistical Analysis

  + Determine the effect of virtual classrooms on students’     academic performance. 

  + Verify if the cost of running the two methods is the same

  + Verify if the performance of students vary by departments


#### EDA (Analysis and Visualization)

```{r}
#importing the necessary library
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggrepel)
#install.packages("scales")
library(scales)
#importing the data

data<-read.csv( "my_project_data.csv")
dim(data)
```
```{r}

```

#### Descriptive Statistics
```{r}
summary(data)
```


#### Gender
```{r}
pie <- ggplot(data, aes(x = "", fill = Gender)) +
  geom_bar(width = 1, color = "white") +
  coord_polar(theta = "y") +
  ggtitle("Response By Gender") +
  theme_void()

# Add labels to the pie chart
pie + geom_text(aes(label = ..count..),
                stat = "count",
                position = position_stack(vjust = 0.5))

```

##### Preference
```{r}
pie <- ggplot(data, aes(x = "", fill = Which.of.the.two.methods.would.you.prefer.)) +
  geom_bar(width = 1, color = "white") +
  coord_polar(theta = "y") +
  ggtitle("Preference Chart") +
  labs(fill = "Preference")+
  theme_void()

# Add labels to the pie chart
pie + geom_text(aes(label = scales::percent(..count../sum(..count..))), 
            stat = "count", 
            position = position_stack(vjust = 0.5))
```

#### Gender by Level
```{r}
ggplot(data, aes(x = factor(Level), fill = factor(Gender))) +
  geom_bar() +
  labs(title = "Stundents' Gender By Level",
       x = "Level",
       y = "Number Of Stundents") +
  scale_fill_discrete(name = "Gender")
```


#### Preference by Gender and Level

```{r}
ggplot(data, aes(x = Which.of.the.two.methods.would.you.prefer., fill = Gender)) +
  geom_bar(position = "dodge") +
  facet_grid(. ~ Level) +
  labs( title = "     Preference by Gender and Level", x = "Method", y = "Number Of Students", fill = "Gender") +
  stat_count(geom = "text", aes(label = ..count..), position = position_dodge(width = 0.9), vjust = -0.5)
```

#### Preference by Department
```{r}
ggplot(data, aes(x = factor(Department), fill = factor(Which.of.the.two.methods.would.you.prefer.)))+
  geom_bar()+ 
  labs(title = "        Students' Preference By Department", x= 'Department',
       y= "Number of Stundents") + scale_fill_discrete(name = "Method")
```

#### Age distribution by preference 
```{r}
ggplot(data, aes(x = factor(Age), fill = factor(Which.of.the.two.methods.would.you.prefer.)))+
  geom_bar()+ 
  labs(title = "        Students' Preference By Age Group", x= 'Age',
       y= "Number of Stundents") + scale_fill_discrete(name = "Method")
```


#### BOX Plot for amount Spent on the method.
```{r}

dat <- data.frame(
  
  Physical = data$The.average.amount.spent.in.a.week.on.physical.classes.including.transportation,
  Virtual = data$The.average.amount.spent.on.VLE.including.data.charges.per.week)

# Reshape data into long format
data_long <- gather(dat, key = "column", value = "value", Physical, Virtual)
# Create combined box plot
ggplot(data_long, aes(x = '', y = value)) +
  geom_boxplot() +
  facet_wrap(~ column, scales = "free_y") +
  labs(x = "Method", y = "") +
  ggtitle("Box plot for Amount Spent On Physical and Virtual Classes")

```


#### CGPA by preference
```{r}

data <- data %>%
  mutate(CGPA = (GPA.during.physical.classes + GPA.during.VLE ) / 2) %>%
  mutate(CGPA = case_when(
    CGPA >= 4.5 ~ "First Class",
    CGPA >= 3.5 & CGPA < 4.5  ~ "Second Class Upper",
    CGPA >= 2.5 & CGPA < 3.5  ~ "Second Class Lower Division",
    CGPA >= 1.5 & CGPA <2.5  ~ "Third Class",
    CGPA < 1.5  ~ "Pass",
  ))

ggplot(data, aes(x = CGPA, fill = Which.of.the.two.methods.would.you.prefer.)) +
  geom_bar() +
  labs(title = "        Preference By CGPA", x= 'CGPA', fill = 'Preference',
       y= "Number of Stundents") +
  geom_text(aes(label = ..count..),
                  stat = "count",
                  position = position_stack(vjust = 0.5))
```


#### First_class per Department
```{r}
first_class = data[data$CGPA == 'First Class',]

ggplot(first_class, aes(x= Department))+geom_bar()+
  labs(title = "        First Class Per Department",
       y= "Number of Stundents", color = 'red') +
  geom_text(aes(label = ..count..),
            stat = "count",
            position = position_stack(vjust = 0.5))
```

### Statistics Analysis


#### Data Cleaning
```{r}
# Identify outlier values using boxplot
outlier <- boxplot(data$The.average.amount.spent.in.a.week.on.physical.classes.including.transportation)$out

# Remove rows with outlier values (The Amount ROWs)
mydata <- subset(data, !The.average.amount.spent.in.a.week.on.physical.classes.including.transportation %in% outlier) 
outlier2 <- boxplot(mydata$The.average.amount.spent.on.VLE.including.data.charges.per.week)$out

# Remove rows with outlier values
mydata <- subset(mydata,!The.average.amount.spent.on.VLE.including.data.charges.per.week %in% outlier2)
dim(mydata)
```





#### Paired T Test for GPA 
##### (Determine the effect of virtual classrooms on students’ academic performance.)

+ Hypothesis:

  + H0: There is no significant difference in the performance  of students before and after the virtuallearning.
 
  + H1: There is significant difference in the performance of students before and after the virtual learning. 

```{r}
t.test(data$GPA.during.physical.classes, data$GPA.during.VLE, paired = TRUE, conf.level = 0.95) 
```
Interpretation: The p-value (0.0001351) < 0.05, which implies that we fail to accept the null hypothesis i.e. There is significant difference in Students' Performance before and after the Virtual Class


#### Difference of two means for amount
##### (To Verify if the cost of running the two methods is the same)

+ Hypothesis:

  + H0: There is no significant difference in the cost of running the two methods.
  
  + H1: There is significant difference in the cost of running the two methods.


```{r}
t.test(mydata$The.average.amount.spent.in.a.week.on.physical.classes.including.transportation , data$The.average.amount.spent.on.VLE.including.data.charges.per.week , paired = FALSE, conf.level = 0.95)
```
Interpretation: The p-value < 0.05, which implies that we fail to accept the null hypothesis i.e. There is significant difference in the cost of running the two methods


```{r}

```


#### Anova (Verify if the performance of students vary by departments)


+Hypothesis:

  + H0: Performance Of Student are the same across the departments
  
  + H1: Performance Of Student are not the same across the departments
```{r}
#Performance by Department
sts =subset(data,Department=='Statistics')
mts =subset(data,Department=='Mathematics')
chm =subset(data,Department=='Chemistry')
phs =subset(data,Department=='Physics')
csc =subset(data,Department=='Computer Science')


#physical
department = c(rep('sts', 50), rep('mts', 50),rep('chm', 50),rep('phs', 50)
               ,rep('csc', 50))
gpa = c(sts$GPA.during.physical.classes,mts$GPA.during.physical.classes,chm$GPA.during.physical.classes,
        phs$GPA.during.physical.classes,csc$GPA.during.physical.classes)
dept = data.frame(department,gpa)
dept_analysis<- aov(gpa~department, data = dept)
summary(dept_analysis)
```


```{r}

#virtual

department = c(rep('sts', 50), rep('mts', 50),rep('chm', 50),rep('phs', 50)
               ,rep('csc', 50))
gpa_v = c(sts$GPA.during.VLE,mts$GPA.during.VLE,chm$GPA.during.VLE,
          phs$GPA.during.VLE,csc$GPA.during.VLE)
dept_v = data.frame(department,gpa_v)
dept_analysis_v<- aov(gpa_v~department, data = dept_v)
summary(dept_analysis_v)
```

Interpretation: From the two tests above the p-value > 0.05, which implies that we accept the null hypothesis i.e. There is no significant difference in the Performance of Student across departments for the two methods of Learning.

### Summary Of Findings

+ The newly adopted virtual classroom has an adverse effect on students academic performance 

+ The cost of running the method is different significantly from the regular method (Physical Classrooms)

+ The ratio of preference of physical classroom to virtual is 2 to 1

### Conclusion
Based on the result obtained, we can conclude that the newly (Virtual) adopted method has effect on students’ academic performance and the cost of running the method is not the same with the physical classroom method. 

### Recommendation
The country's education system is not ready to be digitalized completely or moved to Virtual learning, as the system cannot guarantee the effectiveness of the method. Hence, physical classes should continue and the school may consider mixed method which will be more physical than virtual to prepare the students for outside school and to avoid the loss of knowledge.



#### Check the Report for proper understanding.




